{% extends "base.html" %}

{% block title %}TwÃ³j plan dla: {{ plan.query.city }}{% endblock %}

{% block content %}
<div class="container plan-results">
    
    <header class="plan-header">
        <h1>Plan podrÃ³Å¼y: {{ plan.query.city }}</h1>
        <p class="subtitle">
            <span class="badge days-badge">{{ plan.query.days }} dni</span>
            <span class="badge style-badge">{{ plan.query.style }}</span>
        </p>
    </header>

    <!-- Pogoda - gÃ³rna sekcja -->
    <div class="card weather-card weather-top">

        <h2><span class="icon">â˜€ï¸</span> Pogoda</h2>

        <div class="weather-details">
                {% if plan.weather.daily is defined %}

                <div class="daily-weather-list">
                    {% for day in plan.weather.daily %}
                    <div class="daily-item weather-card">

                        <div class="day-header">
                            <h3 class="date-display">{{ day.date_label or day.date }}</h3>
                        </div>
                        
                        <div class="day-icon-container">
                            <!-- ZastÄ™pujemy Å‚adowanie SVG prostÄ… emoji/ikonkÄ… wklejonÄ… inline -->
                            <div class="weather-emoji">{{ day.icon_emoji or day.icon or 'ğŸŒ¤ï¸' }}</div>
                            <div class="weather-icon-key {% if day.icon_key %}weather-{{ day.icon_key }}{% endif %}" data-weather="{{ day.weathercode or '' }}">{{ day.opis or 'Brak danych' }}</div>
                        </div>

                        <div class="day-temp">
                            <h3>DzieÅ„/Noc</h3>
                            <div>
                                <span class="temp-max">
                                {% if day.temperatura_max is defined %}{{ day.temperatura_max }}Â°C{% else %}-{% endif %}
                                </span>
                                <span class="temp-min">
                                    {% if day.temperatura_min is defined %}{{ day.temperatura_min }}Â°C{% else %}-{% endif %}
                                </span>
                            </div>
                        </div>

                        <div class="day-details">
                            {% if day.opad_mm is defined %}
                            <div class="detail-item">
                                <span class="detail-icon">ğŸ’§ Opad:</span><strong>{{ day.opad_mm }} mm</strong>
                            </div>
                            {% endif %}
                    
                            {% if day.wiatr_kmh is defined %}
                            <div class="detail-item">
                                <span class="detail-icon">ğŸŒ¬ï¸ Wiatr:</span><strong>{{ day.wiatr_kmh }} km/h</strong>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- {% else %}
                <p>Åšrednia temperatura: <strong>{{ plan.weather.temperatura }}Â°C</strong></p>
                {% if plan.weather.temperatura_min is defined and plan.weather.temperatura_max is defined %}
                <p>Min / Max: <strong>{{ plan.weather.temperatura_min }}Â°C</strong> / <strong>{{ plan.weather.temperatura_max }}Â°C</strong></p>
                {% endif %}
                {% if plan.weather.wilgotnosc is defined %}
                <p>WilgotnoÅ›Ä‡: <strong>{{ plan.weather.wilgotnosc }}%</strong></p>
                {% endif %}
                <p>Warunki: {{ plan.weather.opis }}</p>
                {% if plan.weather.wiatr_kmh is defined %}
                <p>PrÄ™dkoÅ›Ä‡ wiatru: {{ plan.weather.wiatr_kmh }} km/h</p>
                {% endif %}
                {% endif %} -->
        </div>
    </div>

    <div class="info-grid">
        
        <div class="card budget-card">
            <h2><span class="icon">ğŸ’°</span> Szacowany budÅ¼et</h2>
            {% if plan.cost.total_pln is not none %}
                <p class="main-cost">CaÅ‚kowity koszt: <strong>{{ plan.cost.total_pln }} PLN</strong></p>
                <p>Koszt w walucie lokalnej: {{ plan.cost.total_local }} {{ plan.cost.currency }}</p>
            {% else %}
                <p class="info-note">Dla tego miasta nie mamy jeszcze danych o szacunkowych kosztach.</p>
            {% endif %}
        </div>
        
        <!-- 'WaÅ¼ne obiekty' section removed as requested -->
    </div>
    
    <div class="attractions-section">
        <h2><span class="icon">ğŸ›ï¸</span> GÅ‚Ã³wne atrakcje</h2>
        
        <div class="attraction-cards">
            {% if plan.attractions and plan.attractions|length > 0 %}
                {% for attraction in plan.attractions %}
                <div class="attraction-card card">
                    <input class="card-checkbox" id="cards-{{ loop.index0 }}" name="cards" type="checkbox" value="{{ attraction.name }}">
                    <label for="cards-{{ loop.index0 }}" class="cards-card">
                        
                        {% if attraction.photo_url %}
                        <div class="attraction-image-container">
                            <img src="{{ attraction.photo_url }}" alt="{{ attraction.name }}" class="attraction-photo">
                        </div>
                        {% elif attraction.icon %}
                        <div class="attraction-icon-container">
                            <img src="{{ attraction.icon }}" alt="Ikona" class="attraction-icon">
                        </div>
                        {% endif %}

                        <div class="card-header">
                            <h3 class="attraction-name">{{ attraction.name }}</h3>
                        </div>
                        
                        <div class="card-body">
                            {% if attraction.address %}
                            <p class="attraction-address">{{ attraction.address }}</p>
                            {% endif %}
                            
                            <div class="attraction-meta">
                                {% if attraction.rating %}
                                <span class="badge rating-badge">â­ {{ attraction.rating }}</span>
                                {% endif %}
                                
                                {% if attraction.price_level %}
                                <span class="badge price-badge">
                                    {% for i in range(attraction.price_level) %}${% endfor %}
                                </span>
                                {% endif %}
                            </div>
                            
                            {% if attraction.types %}
                            <div class="attraction-types">
                                {% for type in attraction.types[:4] %}
                                <span class="badge type-badge" style="text-transform:capitalize;">{{ type }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </label>
                </div>
                {% endfor %}
            {% else %}
                <p>Brak danych o atrakcjach dla tego miasta.</p>
            {% endif %}
        </div>
    </div>
<div class="save">
        <button class="zapisz btn btn-primary"><span class="icon">ğŸ’¾</span> Zapisz plan</button>
</div>

    <div class="action-buttons">
        <button class="btn btn-secondary"><span class="icon">ğŸ“„</span> Pobierz jako PDF</button>
    </div>
    
</div>
{% endblock %}

{% block scripts %}
<!-- Skrypty JS usuniÄ™te - renderowanie odbywa siÄ™ po stronie serwera -->
{% endblock %}